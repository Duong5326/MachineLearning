{% extends 'layout.html' %}

{% block title %}Trực Quan Hóa Kết Quả Phân Tích ML{% endblock %}

{% block content %}
<div class="container py-4">
    <section class="visualization-header text-center mb-5">
        <h1 class="page-title">Kết Quả Phân Tích Mô Hình (ML)</h1>
    </section>

    {% if missing_files %}
    <div class="alert alert-warning" role="alert">
        <h4 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Cảnh báo: Thiếu file ảnh</h4>
        <p>Một số file ảnh phân tích không tìm thấy trong thư mục <strong>/static</strong>.</p>
        <hr>
        <p class="mb-0">Vui lòng chạy toàn bộ 8 cell notebook (đặc biệt là Cell 2, 3, 5, 6, 7) để tạo ra 8 file .png, sau đó <strong>copy chúng từ `data/processed/models/` vào thư mục `static/`</strong>.</p>
    </div>
    {% endif %}

    {% if not images %}
    <div class="alert alert-info text-center" role="alert">
        <h4 class="alert-heading">Không tìm thấy ảnh kết quả.</h4>
        <p>Vui lòng chạy 8 cell notebook huấn luyện và copy các file .png vào thư mục /static.</p>
    </div>
    {% else %}
    <div class="row row-cols-1 g-4">
        {% for img in images %}
        <div class="col">
            <div class="card h-100 shadow-sm">
                <div class="card-header bg-light">
                    <h2 class="card-title h5 mb-0">{{ img.title }}</h2>
                </div>
                <div class="card-body bg-light p-3 p-md-4 text-center">
                       <!-- Copy-Item -Path "data\processed\models\*.png" -Destination "static\" -Force -->
                <img src="{{ url_for('static', filename=img.file) }}" 
                    alt="{{ img.title }}" 
                    class="img-fluid rounded border"
                    style="max-height: 700px; width: auto;"
                    onerror="this.parentElement.innerHTML='<p class=\'text-danger p-4\'>Lỗi tải ảnh: <strong>{{ img.file }}</strong>. Ảnh không tồn tại trong thư mục static.</p>';">
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="mt-5 text-center action-buttons">
        <a href="/" class="btn btn-primary btn-lg">
            <i class="fas fa-arrow-left me-2"></i>
            Quay lại trang chủ
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
{% endblock %}