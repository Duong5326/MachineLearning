{% extends 'layout.html' %}

{% block title %}Kết Quả Phân Loại Xe{% endblock %}

{% block content %}
<div class="classification-container">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card result-card">
                <div class="card-header bg-primary text-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2 class="card-title mb-0">Kết Quả Phân Loại Xe</h2>
                        <span class="segment-badge {{ segment|lower }}">{{ segment }}</span>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row mb-4">
                        <div class="col-lg-6">
                            <h3 class="mb-3">Thông tin xe</h3>
                            <div class="info-item">
                                <i class="fas fa-trademark me-2"></i>
                                <span class="info-label">Thương hiệu:</span> 
                                <span class="info-value">{{ brand }}</span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-calendar-alt me-2"></i>
                                <span class="info-label">Năm sản xuất:</span> 
                                <span class="info-value">{{ year }}</span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-car me-2"></i>
                                <span class="info-label">Kiểu dáng:</span> 
                                <span class="info-value">{{ body_type }}</span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-tachometer-alt me-2"></i>
                                <span class="info-label">Dung tích động cơ:</span> 
                                <span class="info-value">{{ engine_capacity }} lít</span>
                            </div>
                        </div>
                        
                        <div class="col-lg-6">
                            <h3 class="mb-3">Kết quả phân loại</h3>
                            <div class="result-box p-3 border rounded">
                                <div class="info-item">
                                    <i class="fas fa-tags me-2"></i>
                                    <span class="info-label">Phân khúc:</span> 
                                    <span class="info-value">{{ segment }}</span>
                                </div>
                                <div class="info-item">
                                    <i class="fas fa-money-bill-wave me-2"></i>
                                    <span class="info-label">Giá ước tính:</span> 
                                    <span class="info-value fs-4 fw-bold text-primary">{{ formatted_price }}</span>
                                </div>
                                <div class="info-item">
                                    <i class="fas fa-percent me-2"></i>
                                    <span class="info-label">Độ tin cậy:</span> 
                                    <span class="info-value">
                                        <div class="progress" style="height: 20px;">
                                            <div class="progress-bar bg-{{ 'success' if confidence >= 80 else 'warning' if confidence >= 60 else 'danger' }}" 
                                                 role="progressbar" 
                                                 aria-valuenow="{{ confidence|int }}" 
                                                 aria-valuemin="0" 
                                                 aria-valuemax="100">
                                                {{ confidence }}%
                                            </div>
                                        </div>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    {% if features %}
                    <div class="features-section mb-4">
                        <h3 class="mb-3">Tính năng xe</h3>
                        <div class="row">
                            {% for feature in features %}
                            <div class="col-md-4 mb-2">
                                <div class="feature-tag">
                                    <i class="fas fa-check-circle me-2 text-success"></i>
                                    {% if feature == "Navigation" %}
                                    Định vị GPS
                                    {% elif feature == "Sunroof" %}
                                    Cửa sổ trời
                                    {% elif feature == "LeatherSeats" %}
                                    Ghế da
                                    {% elif feature == "Bluetooth" %}
                                    Bluetooth
                                    {% elif feature == "CruiseControl" %}
                                    Kiểm soát hành trình
                                    {% elif feature == "ParkingSensors" %}
                                    Cảm biến đỗ xe
                                    {% elif feature == "Camera" %}
                                    Camera lùi
                                    {% elif feature == "KeylessEntry" %}
                                    Khởi động không cần chìa
                                    {% else %}
                                    {{ feature }}
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    <div class="segment-info mb-4">
                        <h3 class="mb-3">Thông tin phân khúc</h3>
                        <div class="alert alert-info">
                            {% if segment == 'Luxury' %}
                                <h5 class="alert-heading">Phân khúc xe sang</h5>
                                <p>Phân khúc xe sang là những mẫu xe cao cấp nhất trên thị trường, với giá trên 1.5 tỷ đồng. Các xe này thường có đầy đủ tính năng cao cấp, thiết kế sang trọng và thương hiệu uy tín.</p>
                                <p>Thương hiệu thường gặp: Mercedes-Benz, BMW, Lexus, Audi</p>
                            {% elif segment == 'Premium' %}
                                <h5 class="alert-heading">Phân khúc xe cao cấp</h5>
                                <p>Phân khúc xe cao cấp với giá từ 800 triệu đến 1.5 tỷ đồng, thường là các mẫu top-end của thương hiệu phổ thông hoặc mẫu entry-level của thương hiệu hạng sang.</p>
                                <p>Thương hiệu thường gặp: Toyota high-end, Honda high-end, Mercedes-Benz entry-level, BMW entry-level</p>
                            {% elif segment == 'Mid-range' %}
                                <h5 class="alert-heading">Phân khúc xe trung cấp</h5>
                                <p>Phân khúc xe trung cấp với giá từ 500 đến 800 triệu đồng, là lựa chọn phổ biến với nhiều người dùng vì cân bằng giữa chi phí và tính năng.</p>
                                <p>Thương hiệu thường gặp: Toyota, Honda, Mazda, Ford, Kia, Hyundai</p>
                            {% elif segment == 'Economy' %}
                                <h5 class="alert-heading">Phân khúc xe tiết kiệm</h5>
                                <p>Phân khúc xe tiết kiệm với giá dưới 500 triệu đồng, chủ yếu là các mẫu xe nhỏ gọn, tiết kiệm nhiên liệu, phù hợp với đô thị.</p>
                                <p>Thương hiệu thường gặp: Kia, Hyundai, Toyota (mẫu nhỏ), Suzuki</p>
                            {% else %}
                                <h5 class="alert-heading">Thông tin phân khúc</h5>
                                <p>Không có thông tin chi tiết cho phân khúc này.</p>
                            {% endif %}
                        </div>
                    </div>

                    <div class="similar-models mb-4">
                        <h3 class="mb-3">Các mẫu xe tương tự</h3>
                        <div class="row">
                            {% if similar_models %}
                                {% for model in similar_models %}
                                <div class="col-md-4">
                                    <div class="similar-model-card">
                                        <div class="model-name">{{ model.brand }} {{ model.model }}</div>
                                        <div class="model-segment"><span class="segment-badge {{ model.segment|lower }}">{{ model.segment }}</span></div>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                                {% set fallback_models = {
                                   
                                        {'brand': 'Mercedes-Benz', 'model': 'E-Class'},
                                        {'brand': 'BMW', 'model': '5 Series'},
                                        {'brand': 'Lexus', 'model': 'ES'}
                                    ],
                                    'Premium': [
                                        {'brand': 'Toyota', 'model': 'Camry'},
                                        {'brand': 'Honda', 'model': 'Accord'},
                                        {'brand': 'Mazda', 'model': 'CX-5'}
                                    ],
                                    'Mid-range': [
                                        {'brand': 'Honda', 'model': 'Civic'},
                                        {'brand': 'Toyota', 'model': 'Corolla Cross'},
                                        {'brand': 'Mazda', 'model': '3'}
                                    ],
                                    'Economy': [
                                        {'brand': 'Kia', 'model': 'Morning'},
                                        {'brand': 'Hyundai', 'model': 'i10'},
                                        {'brand': 'Toyota', 'model': 'Wigo'}
                                    ]
                                } %}
                                
                                {% set models = fallback_models[segment] if segment in fallback_models else fallback_models['Mid-range'] %}
                                
                                {% for model in models %}
                                <div class="col-md-4">
                                    <div class="similar-model-card">
                                        <div class="model-name">{{ model.brand }} {{ model.model }}</div>
                                        <div class="model-segment"><span class="segment-badge {{ segment|lower }}">{{ segment }}</span></div>
                                    </div>
                                </div>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons mt-4 text-center">
                <a href="/classify" class="btn btn-primary btn-lg me-2">
                    <i class="fas fa-tags me-2"></i>Phân loại xe khác
                </a>
                <a href="/" class="btn btn-outline-primary btn-lg me-2">
                    <i class="fas fa-home me-2"></i>Trang chủ
                </a>
                <a href="/visualization" class="btn btn-outline-secondary btn-lg">
                    <i class="fas fa-chart-line me-2"></i>Xem phân tích thị trường
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {

    });
</script>
{% endblock %}